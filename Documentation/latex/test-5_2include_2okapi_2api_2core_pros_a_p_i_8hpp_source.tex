\hypertarget{test-5_2include_2okapi_2api_2core_pros_a_p_i_8hpp_source}{}\doxysection{core\+Pros\+API.\+hpp}
\label{test-5_2include_2okapi_2api_2core_pros_a_p_i_8hpp_source}\index{Pros/test-\/5/include/okapi/api/coreProsAPI.hpp@{Pros/test-\/5/include/okapi/api/coreProsAPI.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * This Source Code Form is subject to the terms of the Mozilla Public}}
\DoxyCodeLine{3 \textcolor{comment}{ * License, v. 2.0. If a copy of the MPL was not distributed with this}}
\DoxyCodeLine{4 \textcolor{comment}{ * file, You can obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{5 \textcolor{comment}{ */}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <cstdbool>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <cstddef>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <cstdio>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <cstdlib>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <thread>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define CROSSPLATFORM\_THREAD\_T std::thread}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <mutex>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#define CROSSPLATFORM\_MUTEX\_T std::mutex}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}api.h"{}}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include "{}pros/apix.h"{}}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#define CROSSPLATFORM\_THREAD\_T pros::task\_t}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#define CROSSPLATFORM\_MUTEX\_T pros::Mutex}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#define NOT\_INITIALIZE\_TASK                                                                        \(\backslash\)}}
\DoxyCodeLine{31 \textcolor{preprocessor}{  (strcmp(pros::c::task\_get\_name(pros::c::task\_get\_current()), "{}User Initialization (PROS)"{}}) != 0)}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{preprocessor}{\#define NOT\_COMP\_INITIALIZE\_TASK                                                                   \(\backslash\)}}
\DoxyCodeLine{34 \textcolor{preprocessor}{  (strcmp(pros::c::task\_get\_name(pros::c::task\_get\_current()), "{}User Comp. Init. (PROS)"{}}) != 0)}
\DoxyCodeLine{35 }
\DoxyCodeLine{36 \textcolor{keyword}{class }\mbox{\hyperlink{class_crossplatform_thread}{CrossplatformThread}} \{}
\DoxyCodeLine{37   \textcolor{keyword}{public}:}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{39   \mbox{\hyperlink{class_crossplatform_thread}{CrossplatformThread}}(\textcolor{keywordtype}{void} (*ptr)(\textcolor{keywordtype}{void} *),}
\DoxyCodeLine{40                       \textcolor{keywordtype}{void} *params,}
\DoxyCodeLine{41                       \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\textcolor{keyword}{const} = \textcolor{stringliteral}{"{}OkapiLibCrossplatformTask"{}})}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{43   \mbox{\hyperlink{class_crossplatform_thread}{CrossplatformThread}}(\textcolor{keywordtype}{void} (*ptr)(\textcolor{keywordtype}{void} *),}
\DoxyCodeLine{44                       \textcolor{keywordtype}{void} *params,}
\DoxyCodeLine{45                       \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\textcolor{keyword}{const} name = \textcolor{stringliteral}{"{}OkapiLibCrossplatformTask"{}})}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{47     :}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{49       thread(ptr, params)}
\DoxyCodeLine{50 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{51       thread(}
\DoxyCodeLine{52         pros::c::task\_create(ptr, params, TASK\_PRIORITY\_DEFAULT, TASK\_STACK\_DEPTH\_DEFAULT, name))}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{54   \{}
\DoxyCodeLine{55   \}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57   \mbox{\hyperlink{class_crossplatform_thread}{\string~CrossplatformThread}}() \{}
\DoxyCodeLine{58 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{59     thread.join();}
\DoxyCodeLine{60 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{61     \textcolor{keywordflow}{if} (pros::c::task\_get\_state(thread) != pros::E\_TASK\_STATE\_DELETED) \{}
\DoxyCodeLine{62       pros::c::task\_delete(thread);}
\DoxyCodeLine{63     \}}
\DoxyCodeLine{64 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{65   \}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{68   \textcolor{keywordtype}{void} notifyWhenDeleting(\mbox{\hyperlink{class_crossplatform_thread}{CrossplatformThread}} *) \{}
\DoxyCodeLine{69   \}}
\DoxyCodeLine{70 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{71   \textcolor{keywordtype}{void} notifyWhenDeleting(\mbox{\hyperlink{class_crossplatform_thread}{CrossplatformThread}} *parent) \{}
\DoxyCodeLine{72     pros::c::task\_notify\_when\_deleting(parent-\/>thread, thread, 1, pros::E\_NOTIFY\_ACTION\_INCR);}
\DoxyCodeLine{73   \}}
\DoxyCodeLine{74 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{75 }
\DoxyCodeLine{76 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{77   \textcolor{keywordtype}{void} notifyWhenDeletingRaw(CROSSPLATFORM\_THREAD\_T *) \{}
\DoxyCodeLine{78   \}}
\DoxyCodeLine{79 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{80   \textcolor{keywordtype}{void} notifyWhenDeletingRaw(CROSSPLATFORM\_THREAD\_T parent) \{}
\DoxyCodeLine{81     pros::c::task\_notify\_when\_deleting(parent, thread, 1, pros::E\_NOTIFY\_ACTION\_INCR);}
\DoxyCodeLine{82   \}}
\DoxyCodeLine{83 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{86   std::uint32\_t notifyTake(\textcolor{keyword}{const} std::uint32\_t) \{}
\DoxyCodeLine{87     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{88   \}}
\DoxyCodeLine{89 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{90   std::uint32\_t notifyTake(\textcolor{keyword}{const} std::uint32\_t itimeout) \{}
\DoxyCodeLine{91     \textcolor{keywordflow}{return} pros::c::task\_notify\_take(\textcolor{keyword}{true}, itimeout);}
\DoxyCodeLine{92   \}}
\DoxyCodeLine{93 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95   \textcolor{keyword}{static} std::string getName() \{}
\DoxyCodeLine{96 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{97     std::ostringstream ss;}
\DoxyCodeLine{98     ss << std::this\_thread::get\_id();}
\DoxyCodeLine{99     \textcolor{keywordflow}{return} ss.str();}
\DoxyCodeLine{100 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{101     \textcolor{keywordflow}{return} std::string(pros::c::task\_get\_name(NULL));}
\DoxyCodeLine{102 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{103   \}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105   CROSSPLATFORM\_THREAD\_T thread;}
\DoxyCodeLine{106 \};}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 \textcolor{keyword}{class }\mbox{\hyperlink{class_crossplatform_mutex}{CrossplatformMutex}} \{}
\DoxyCodeLine{109   \textcolor{keyword}{public}:}
\DoxyCodeLine{110   \mbox{\hyperlink{class_crossplatform_mutex}{CrossplatformMutex}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{111 }
\DoxyCodeLine{112   \textcolor{keywordtype}{void} lock() \{}
\DoxyCodeLine{113 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{114     mutex.lock();}
\DoxyCodeLine{115 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{116     \textcolor{keywordflow}{while} (!mutex.take(1)) \{}
\DoxyCodeLine{117     \}}
\DoxyCodeLine{118 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{119   \}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121   \textcolor{keywordtype}{void} unlock() \{}
\DoxyCodeLine{122 \textcolor{preprocessor}{\#ifdef THREADS\_STD}}
\DoxyCodeLine{123     mutex.unlock();}
\DoxyCodeLine{124 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{125     mutex.give();}
\DoxyCodeLine{126 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{127   \}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129   \textcolor{keyword}{protected}:}
\DoxyCodeLine{130   CROSSPLATFORM\_MUTEX\_T mutex;}
\DoxyCodeLine{131 \};}

\end{DoxyCode}
