\hypertarget{test-5_2include_2pros_2rtos_8hpp_source}{}\doxysection{rtos.\+hpp}
\label{test-5_2include_2pros_2rtos_8hpp_source}\index{Pros/test-\/5/include/pros/rtos.hpp@{Pros/test-\/5/include/pros/rtos.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#ifndef \_PROS\_RTOS\_HPP\_}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#define \_PROS\_RTOS\_HPP\_}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}pros/rtos.h"{}}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#undef delay}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <chrono>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <cstdlib>}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <type\_traits>}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{namespace }pros \{}
\DoxyCodeLine{34 \textcolor{keyword}{class }Task \{}
\DoxyCodeLine{35     \textcolor{keyword}{public}:}
\DoxyCodeLine{61     \mbox{\hyperlink{classpros_1_1_task_a2e94f57e088ff9b56b78b5d1d7cb2169}{Task}}(task\_fn\_t function, \textcolor{keywordtype}{void}* parameters = \textcolor{keyword}{nullptr}, std::uint32\_t prio = TASK\_PRIORITY\_DEFAULT,}
\DoxyCodeLine{62                   std::uint16\_t stack\_depth = TASK\_STACK\_DEPTH\_DEFAULT, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* name = \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{63 }
\DoxyCodeLine{83     \mbox{\hyperlink{classpros_1_1_task_a64608b28832c40cf11ddb350a7331a08}{Task}}(task\_fn\_t function, \textcolor{keywordtype}{void}* parameters, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* name);}
\DoxyCodeLine{84 }
\DoxyCodeLine{105     \textcolor{keyword}{template} <\textcolor{keyword}{class} F>}
\DoxyCodeLine{106     \textcolor{keyword}{static} task\_t \mbox{\hyperlink{classpros_1_1_task_a9cb4b14a7a47b4aea4d8e71ae3bd4db2}{create}}(F\&\& function, std::uint32\_t prio = TASK\_PRIORITY\_DEFAULT,}
\DoxyCodeLine{107                          std::uint16\_t stack\_depth = TASK\_STACK\_DEPTH\_DEFAULT, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* name = \textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{108         \textcolor{keyword}{static\_assert}(std::is\_invocable\_r\_v<void, F>);}
\DoxyCodeLine{109         \textcolor{keywordflow}{return} pros::c::task\_create(}
\DoxyCodeLine{110             [](\textcolor{keywordtype}{void}* parameters) \{}
\DoxyCodeLine{111                 std::unique\_ptr<std::function<void()>> ptr\{\textcolor{keyword}{static\_cast<}std::function<\textcolor{keywordtype}{void}()\textcolor{keyword}{>}*>(parameters)\};}
\DoxyCodeLine{112                 (*ptr)();}
\DoxyCodeLine{113             \},}
\DoxyCodeLine{114             \textcolor{keyword}{new} std::function<void()>(std::forward<F>(function)), prio, stack\_depth, name);}
\DoxyCodeLine{115     \}}
\DoxyCodeLine{116 }
\DoxyCodeLine{131     \textcolor{keyword}{template} <\textcolor{keyword}{class} F>}
\DoxyCodeLine{132     \textcolor{keyword}{static} task\_t \mbox{\hyperlink{classpros_1_1_task_ab328832af79235e2799b244ee53d3911}{create}}(F\&\& function, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* name) \{}
\DoxyCodeLine{133         \textcolor{keywordflow}{return} \mbox{\hyperlink{classpros_1_1_task_a9cb4b14a7a47b4aea4d8e71ae3bd4db2}{Task::create}}(std::forward<F>(function), TASK\_PRIORITY\_DEFAULT, TASK\_STACK\_DEPTH\_DEFAULT, name);}
\DoxyCodeLine{134     \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{156     \textcolor{keyword}{template} <\textcolor{keyword}{class} F>}
\DoxyCodeLine{157     \textcolor{keyword}{explicit} \mbox{\hyperlink{classpros_1_1_task_a6574af1a29f3031904fc75bf67563c00}{Task}}(F\&\& function, std::uint32\_t prio = TASK\_PRIORITY\_DEFAULT, std::uint16\_t stack\_depth = TASK\_STACK\_DEPTH\_DEFAULT,}
\DoxyCodeLine{158          \textcolor{keyword}{const} \textcolor{keywordtype}{char}* name = \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{159         : \mbox{\hyperlink{classpros_1_1_task}{Task}}(}
\DoxyCodeLine{160               [](void* parameters) \{}
\DoxyCodeLine{161                   std::unique\_ptr<std::function<void()>> ptr\{\textcolor{keyword}{static\_cast<}std::function<\textcolor{keywordtype}{void}()\textcolor{keyword}{>}*>(parameters)\};}
\DoxyCodeLine{162                   (*ptr)();}
\DoxyCodeLine{163               \},}
\DoxyCodeLine{164               \textcolor{keyword}{new} std::function<void()>(std::forward<F>(function)), prio, stack\_depth, name) \{}
\DoxyCodeLine{165         \textcolor{keyword}{static\_assert}(std::is\_invocable\_r\_v<void, F>);}
\DoxyCodeLine{166     \}}
\DoxyCodeLine{167 }
\DoxyCodeLine{182     \textcolor{keyword}{template} <\textcolor{keyword}{class} F>}
\DoxyCodeLine{183     \mbox{\hyperlink{classpros_1_1_task_ada7a776e565ab35ebe4737747cca9926}{Task}}(F\&\& function, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* name)}
\DoxyCodeLine{184         : \mbox{\hyperlink{classpros_1_1_task}{Task}}(std::forward<F>(function), TASK\_PRIORITY\_DEFAULT, TASK\_STACK\_DEPTH\_DEFAULT, name) \{\}}
\DoxyCodeLine{185 }
\DoxyCodeLine{193     \textcolor{keyword}{explicit} \mbox{\hyperlink{classpros_1_1_task_a0b37b46942f1ba25513729b15a32e12f}{Task}}(task\_t task);}
\DoxyCodeLine{194 }
\DoxyCodeLine{198     \textcolor{keyword}{static} \mbox{\hyperlink{classpros_1_1_task}{Task}} \mbox{\hyperlink{classpros_1_1_task_a510ca3e67e54aa4293438d73148a1d6b}{current}}();}
\DoxyCodeLine{199 }
\DoxyCodeLine{207     \mbox{\hyperlink{classpros_1_1_task}{Task}}\& \mbox{\hyperlink{classpros_1_1_task_a95e70532f42a21702d925c95d7432590}{operator=}}(task\_t in);}
\DoxyCodeLine{208 }
\DoxyCodeLine{216     \textcolor{keywordtype}{void} \mbox{\hyperlink{classpros_1_1_task_a45269807dfc87bb1d5e9580346793e9d}{remove}}();}
\DoxyCodeLine{217 }
\DoxyCodeLine{223     std::uint32\_t \mbox{\hyperlink{classpros_1_1_task_a2a9dc12bb0799f8b18333ebcd7571e5b}{get\_priority}}();}
\DoxyCodeLine{224 }
\DoxyCodeLine{235     \textcolor{keywordtype}{void} \mbox{\hyperlink{classpros_1_1_task_a205a9937d34311ba10f540bc58d0b0b9}{set\_priority}}(std::uint32\_t prio);}
\DoxyCodeLine{236 }
\DoxyCodeLine{242     std::uint32\_t \mbox{\hyperlink{classpros_1_1_task_a0e1c154b709095c4884d325d79a839e3}{get\_state}}();}
\DoxyCodeLine{243 }
\DoxyCodeLine{247     \textcolor{keywordtype}{void} \mbox{\hyperlink{classpros_1_1_task_a07d452a967a2bd839f6e819ff26ff052}{suspend}}();}
\DoxyCodeLine{248 }
\DoxyCodeLine{255     \textcolor{keywordtype}{void} \mbox{\hyperlink{classpros_1_1_task_abb8b8aa01d13ba3992953d0a7d668a47}{resume}}();}
\DoxyCodeLine{256 }
\DoxyCodeLine{262     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* \mbox{\hyperlink{classpros_1_1_task_aa8521f655ff019d11caddb513afbb50e}{get\_name}}();}
\DoxyCodeLine{263 }
\DoxyCodeLine{267     \textcolor{keyword}{explicit} \textcolor{keyword}{operator} task\_t() \{}
\DoxyCodeLine{268         \textcolor{keywordflow}{return} task;}
\DoxyCodeLine{269     \}}
\DoxyCodeLine{270 }
\DoxyCodeLine{280     std::uint32\_t \mbox{\hyperlink{classpros_1_1_task_af7ce264851745a555bb141884a1a61ab}{notify}}();}
\DoxyCodeLine{281 }
\DoxyCodeLine{291     \textcolor{keywordtype}{void} \mbox{\hyperlink{classpros_1_1_task_af250c6e369dd2621a8b31d7ed085f819}{join}}();}
\DoxyCodeLine{292 }
\DoxyCodeLine{315     std::uint32\_t \mbox{\hyperlink{classpros_1_1_task_add5bc6272aaa903fdf8ae6656d8ffddb}{notify\_ext}}(std::uint32\_t value, notify\_action\_e\_t action, std::uint32\_t* prev\_value);}
\DoxyCodeLine{316 }
\DoxyCodeLine{333     \textcolor{keyword}{static} std::uint32\_t \mbox{\hyperlink{classpros_1_1_task_a7a7d29a221c08cda730ca9eb8c026a12}{notify\_take}}(\textcolor{keywordtype}{bool} clear\_on\_exit, std::uint32\_t timeout);}
\DoxyCodeLine{334 }
\DoxyCodeLine{343     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classpros_1_1_task_a69c4d78a733f65cff31d7ab19d3f42f5}{notify\_clear}}();}
\DoxyCodeLine{344 }
\DoxyCodeLine{355     \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{classpros_1_1_task_a4341b580544831eea11b840cf068587b}{delay}}(\textcolor{keyword}{const} std::uint32\_t milliseconds);}
\DoxyCodeLine{356 }
\DoxyCodeLine{370     \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{classpros_1_1_task_aa038d0eeb973ce7fca8689fa5bb91fec}{delay\_until}}(std::uint32\_t* \textcolor{keyword}{const} prev\_time, \textcolor{keyword}{const} std::uint32\_t delta);}
\DoxyCodeLine{371 }
\DoxyCodeLine{380     \textcolor{keyword}{static} std::uint32\_t \mbox{\hyperlink{classpros_1_1_task_ace43489ca71bdd884e4518700a4bbe58}{get\_count}}();}
\DoxyCodeLine{381 }
\DoxyCodeLine{382     \textcolor{keyword}{private}:}
\DoxyCodeLine{383     task\_t task\{\};}
\DoxyCodeLine{384 \};}
\DoxyCodeLine{385 }
\DoxyCodeLine{386 \textcolor{comment}{// STL Clock compliant clock}}
\DoxyCodeLine{387 \textcolor{keyword}{struct }Clock \{}
\DoxyCodeLine{388     \textcolor{keyword}{using }rep = std::uint32\_t;}
\DoxyCodeLine{389     \textcolor{keyword}{using }period = std::milli;}
\DoxyCodeLine{390     \textcolor{keyword}{using }duration = std::chrono::duration<rep, period>;}
\DoxyCodeLine{391     \textcolor{keyword}{using }time\_point = std::chrono::time\_point<Clock>;}
\DoxyCodeLine{392     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_steady = \textcolor{keyword}{true};}
\DoxyCodeLine{393 }
\DoxyCodeLine{401     \textcolor{keyword}{static} time\_point \mbox{\hyperlink{structpros_1_1_clock_aaec25b20cdd660b666c029bb73ea4f86}{now}}();}
\DoxyCodeLine{402 \};}
\DoxyCodeLine{403 }
\DoxyCodeLine{404 \textcolor{keyword}{class }\mbox{\hyperlink{classpros_1_1_mutex}{Mutex}} \{}
\DoxyCodeLine{405     std::shared\_ptr<std::remove\_pointer\_t<mutex\_t>> mutex;}
\DoxyCodeLine{406 }
\DoxyCodeLine{407     \textcolor{keyword}{public}:}
\DoxyCodeLine{408     \mbox{\hyperlink{classpros_1_1_mutex}{Mutex}}();}
\DoxyCodeLine{409 }
\DoxyCodeLine{410     \textcolor{comment}{// disable copy and move construction and assignment per Mutex requirements}}
\DoxyCodeLine{411     \textcolor{comment}{// (see https://en.cppreference.com/w/cpp/named\_req/Mutex)}}
\DoxyCodeLine{412     \mbox{\hyperlink{classpros_1_1_mutex}{Mutex}}(\textcolor{keyword}{const} \mbox{\hyperlink{classpros_1_1_mutex}{Mutex}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{413     \mbox{\hyperlink{classpros_1_1_mutex}{Mutex}}(\mbox{\hyperlink{classpros_1_1_mutex}{Mutex}}\&\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{414 }
\DoxyCodeLine{415     \mbox{\hyperlink{classpros_1_1_mutex}{Mutex}}\& operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classpros_1_1_mutex}{Mutex}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{416     \mbox{\hyperlink{classpros_1_1_mutex}{Mutex}}\& operator=(\mbox{\hyperlink{classpros_1_1_mutex}{Mutex}}\&\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{417 }
\DoxyCodeLine{429     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classpros_1_1_mutex_aa6a77cb29b9da78b3ec3fba651abea2e}{take}}();}
\DoxyCodeLine{430 }
\DoxyCodeLine{448     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classpros_1_1_mutex_a70da733375f7b4b68475881578c78516}{take}}(std::uint32\_t timeout);}
\DoxyCodeLine{449 }
\DoxyCodeLine{461     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classpros_1_1_mutex_a0b0000554adeaa949ade594afebf2cb4}{give}}();}
\DoxyCodeLine{462 }
\DoxyCodeLine{478     \textcolor{keywordtype}{void} \mbox{\hyperlink{classpros_1_1_mutex_a5ea32524ab5601fdef345eea66ccf7db}{lock}}();}
\DoxyCodeLine{479 }
\DoxyCodeLine{491     \textcolor{keywordtype}{void} \mbox{\hyperlink{classpros_1_1_mutex_a266d9795310757cdd4e59e377fce6cba}{unlock}}();}
\DoxyCodeLine{492 }
\DoxyCodeLine{503     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classpros_1_1_mutex_a1a70641ba7d85d4d7490194c8f6e1904}{try\_lock}}();}
\DoxyCodeLine{504 }
\DoxyCodeLine{517     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Rep, \textcolor{keyword}{typename} Period>}
\DoxyCodeLine{518     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classpros_1_1_mutex_adb34497c7dbc4bd17640151f4dd3cb70}{try\_lock\_for}}(\textcolor{keyword}{const} std::chrono::duration<Rep, Period>\& rel\_time) \{}
\DoxyCodeLine{519         \textcolor{keywordflow}{return} \mbox{\hyperlink{classpros_1_1_mutex_aa6a77cb29b9da78b3ec3fba651abea2e}{take}}(std::chrono::duration\_cast<Clock::duration>(rel\_time).count());}
\DoxyCodeLine{520     \}}
\DoxyCodeLine{521 }
\DoxyCodeLine{531     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Duration>}
\DoxyCodeLine{532     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classpros_1_1_mutex_ad969519515cf66e45b25b35925aef3a1}{try\_lock\_until}}(\textcolor{keyword}{const} std::chrono::time\_point<Clock, Duration>\& abs\_time) \{}
\DoxyCodeLine{533         \textcolor{keywordflow}{return} \mbox{\hyperlink{classpros_1_1_mutex_aa6a77cb29b9da78b3ec3fba651abea2e}{take}}(std::max(\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(0), (abs\_time -\/ \mbox{\hyperlink{structpros_1_1_clock_aaec25b20cdd660b666c029bb73ea4f86}{Clock::now}}()).count()));}
\DoxyCodeLine{534     \}}
\DoxyCodeLine{535 \};}
\DoxyCodeLine{536 }
\DoxyCodeLine{542 \textcolor{keyword}{using }pros::c::millis;}
\DoxyCodeLine{543 }
\DoxyCodeLine{549 \textcolor{keyword}{using }pros::c::micros;}
\DoxyCodeLine{550 }
\DoxyCodeLine{561 \textcolor{keyword}{using }pros::c::delay;}
\DoxyCodeLine{562 \}  \textcolor{comment}{// namespace pros}}
\DoxyCodeLine{563 }
\DoxyCodeLine{564 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// \_PROS\_RTOS\_HPP\_}}

\end{DoxyCode}
